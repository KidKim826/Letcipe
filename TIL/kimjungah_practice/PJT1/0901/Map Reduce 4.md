## Map Reduce 4



## Naive Bayes Classifier

### 나이브 베이즈 분류기에 알아보기에 앞서, '텍스트 분류'에 대해 알아보자

##### 텍스트 분류란?

- 텍스트를 입력으로 받아 텍스트가 어떤 종류의 범주에 속하는지를 구분하는 작업

  EX) 스팸 메일 분류  - 일반 메일 / 스팸 메일 두 개의 범주를 정한 후, 입력 받은 메일 본문을 두 개의 메일 종류 중 하나로 분류하는 작업이 된다. -- 이진분류

  EX)영화 리뷰 텍스트를 받아 이것이 긍정인지 부정인지 나누는 것은 **감성 분석**, 입력받은 텍스트로 부터 사용자의 의도를 질문/명령/거절 등과 같은 의도를 분류하는 **의도 분석** 같은 문제들이 있음

- 텍스트 분류에서 분류해야할 범주가 '두 가지'라면 **이진분류(Binary Classification)**이라 하며, 세 가지 이상이라면 **다중 클래스 분류(Multi-Class Classification)**이라 한다.

### 나이브 베이즈 분류기

- 특징
  - 단순 베이즈, 독립 베이즈 등 다양한 이름으로 알려짐
  - 모든 특성값은 서로 독립임을 가정.
- 장점
  - 지도 학습 환경에서 효율적으로 훈련 가능 (머신러닝 측면인듯하다)
  - 분류에 필요한 파라미터 추정을 위한 트레이닝 데이터의 양이 매우 적음
  - 간단한 디자인과 단순한 가정에도 불구하고, 많은 복잡한 상황에서 잘 작동함.

- 텍스트 분류를 위해 전통적으로 사용되는 분류기
- 나이브 베이즈 분류기는 인공 신경망 알고리즘에는 속하지 않지만, 머신 러닝의 주요 알고리즘으로 분류에 있어 준수한 성능을 보여줌

##### 베이즈의 정리(Bayes' Theorem)을 이용한 분류 메커니즘

- 베이즈 정리는 조건부 확률을 계산하는 방법 중 하나.

- 베이즈 정리

  ![image-20220901235215562](Map Reduce 4.assets/image-20220901235215562.png)

- 이러한 베이즈 정리를 이용하여 텍스트 분류를 수행하는 것이 나이브 베이즈 분류기.

EX) 스팸 메일 필터를 만든다고 가정해보자. 입력텍스트(메일본문)가 주어졌을 때, 입력 텍스트가 정상 메일인지 스팸메일인지 구분하기 위한 확률은 

- 아래와 같이 표현 가능.

​		**P(정상 메일 | 입력 텍스트) = 입력 텍스트가 있을 때 정상 메일일 확률
​		P(스팸 메일 | 입력 텍스트) = 입력 텍스트가 있을 때 스팸 메일일 확률**

- 베이즈 정리에 따라 표현하면

  **P(정상 메일 | 입력 텍스트) = (P(입력 텍스트 | 정상 메일) × P(정상 메일)) / P(입력 텍스트)
  P(스팸 메일 | 입력 텍스트) = (P(입력 텍스트 | 스팸 메일) × P(스팸 메일)) / P(입력 텍스트)**

  - 간소화 하면 (분모 P 제거)

    **P(정상 메일 | 입력 텍스트) = P(입력 텍스트 | 정상 메일) × P(정상 메일)
    P(스팸 메일 | 입력 텍스트) = P(입력 텍스트 | 스팸 메일) × P(스팸 메일)**

*입력 텍스트는 메일의 본문을 의미한다. 그런데 메일의 본문을 어떻게 나이브 베이즈 분류기의 입력으로 사용할 수 있을까? 메일의 본문을 단어 토큰화하여 이 단어들을 나이브 베이즈의 분류기의 입력으로 사용한다고 한다.*

만약 메일의 본문에 있는 단어가 3개라고 가정했을 때, 기본적으로 나이브 베이즈 분류기는 모든 단어가 독립적이라 가정한다. 메일의 본문의 단어 3개를 w1, w2, w3라 표현하면 나이브 베이즈 분류기의 정상 메일일 확률과 스팸 메일일 확률을 구하는 식은 아래와 같게 나온다고 한다.

**P(정상 메일 | 입력 텍스트) = P(w1 | 정상 메일) × P(w2 | 정상 메일) × P(w3 | 정상 메일) × P(정상 메일)**
**P(스팸 메일 | 입력 텍스트) = P(w1 | 스팸 메일) × P(w2 | 스팸 메일) × P(w3 | 스팸 메일) × P(스팸 메일)**

-  나이브 베이즈 분류기에서 토큰화 이전의 단어의 순서는 중요하지 않다. BoW와 같이 단어의 순서를 무시하고 오직 빈도수만을 고려. 

- 스팸 메일 분류 (https://wikidocs.net/22892) 참고.